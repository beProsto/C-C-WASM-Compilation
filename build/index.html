<meta charset="utf-8">
<style>
	* {
		background-color: rgb(75, 75, 75);
		color: rgb(220, 220, 220);
	}
</style>


<!-- this is just because I don't expect everyone to want to open up the console -->
<script>
	console.log = (str) => {
		document.body.innerHTML += "<h1>" + str + "</h1>";
	}
</script>

<!-- emscripten is very easy to use - not that easy to install however -->
<script src="emscripten/main.js"></script>

<!-- simpler things done with wasm are easy to use -->
<script type="module">
	(async () => {
		const { instance } = await WebAssembly.instantiateStreaming(
			fetch("./llvm/func.wasm")
		);
		console.log("func's result: " + instance.exports.function_name(3, 2));
	})();
</script>

<!-- Here we have a function that returns the address to the start of a static string 
	We read it from the start to finish (when byte hidden under the pointer is NULL) 
	And print the result out on the screen :D -->
<script type="module">
	// well - it's one of the ways to go about it ^^'
	// this buffer will gather our text before "flushing" it into the console :D
	let console_log_buffer = "";

	async function init() {
		const { instance } = await WebAssembly.instantiateStreaming(
			fetch("./llvm/main.wasm"),
			{
				env: {
					// functions to import to our wasm code
					__wasm_import_console_log_add_to_buffer: (a) => { console_log_buffer += String.fromCharCode(a); },
					__wasm_import_console_log_flush_buffer: () => { console.log(console_log_buffer); console_log_buffer = ""; }
				}
			}
		);
		
		// simply runs the "hello" function we defined in our c++
		instance.exports.hello();
	}
	init();
</script>
